<div class="container-fluid admin-dashboard">
  <div class="parking-dashboard">
    <div class="dashboard-cards">
      <div class="card dashboard-card">
        <div class="card-body dasboard-card-body">
          <div class="card-left">
            <h6 class="card-title dashboard-card-title">Total Spots</h6>
            <p class="card-text dashboard-card-text total-spots-count">
              {{ totalSlots }}
            </p>
          </div>
          <div class="card-right"><i class="fa-solid fa-car fa-3x"></i></div>
        </div>
      </div>
      <div class="card dashboard-card">
        <div class="card-body dasboard-card-body">
          <div class="card-left">
            <h6 class="card-title dashboard-card-title">Available</h6>
            <p class="card-text dashboard-card-text available-value">
              {{ availableCount }}
            </p>
          </div>
          <div class="card-right">
            <i class="fa-solid fa-circle-check fa-3x"></i>
          </div>
        </div>
      </div>
      <div class="card dashboard-card">
        <div class="card-body dasboard-card-body">
          <div class="card-left">
            <h6 class="card-title dashboard-card-title">Occupied</h6>
            <p class="card-text dashboard-card-text occupied-value">
              {{ occupiedCount }}
            </p>
          </div>
          <div class="card-right">
            <i class="fa-solid fa-car-side fa-3x"></i>
          </div>
        </div>
      </div>
      <div class="card dashboard-card">
        <div class="card-body dasboard-card-body">
          <div class="card-left">
            <h6 class="card-title dashboard-card-title">Occupancy Rate</h6>
            <p class="card-text dashboard-card-text occupancy-rate-value">
              {{ occupancyRate | number : "1.2-2" }}%
            </p>
          </div>
          <div class="card-right">
            <i class="fa-solid fa-chart-simple fa-3x"></i>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="parking-layout">
    <h3><i class="fa-solid fa-border-all"></i> Parking Layout</h3>
    <div class="legend">
      <span class="legend-item available">Available</span>
      <span class="legend-item occupied">Occupied</span>
      <span class="legend-item reserved">Reserved</span>
      <span class="legend-item maintenance">Maintenance</span>
    </div>
    <div class="parking-grid">
      <div
        class="card layout-card"
        *ngFor="let slot of slots"
        [ngClass]="slot.status.toLowerCase()"
        (click)="onSlotClicked(slot)"
      >
        <div class="card-body layout-card-body">
          <h5 class="card-title layout-card-id">{{ slot.id }}</h5>
          <p class="card-text layout-card-status">{{ slot.status }}</p>
          <p class="card-text layout-card-vehicle" *ngIf="slot.vehicleNumber">
            {{ slot.vehicleNumber }}
          </p>
          <p class="card-text layout-card-person" *ngIf="slot.bookedBy">
            {{ slot.bookedBy }}
          </p>
        </div>
      </div>
    </div>
  </div>
  <!-- Park Vehicle Modal -->
  <div
    class="modal fade"
    id="slotBookingModal"
    tabindex="-1"
    aria-labelledby="bookingModalLabel"
    aria-hidden="true"
  >
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h1 class="modal-title fs-5" id="slotBookingModalTitle">
            Book Slot - {{ selectedSlot?.id }}
          </h1>
          <button
            type="button"
            class="btn-close"
            data-bs-dismiss="modal"
            aria-label="Close"
          ></button>
        </div>
        <div class="modal-body">
          <form [formGroup]="slotBookingForm">
            <!-- Vehicle Number -->
            <div class="form-group">
              <label for="vehicleNumber" class="form-label"
                >Vehicle Number</label
              >
              <input
                type="text"
                name="vehicleNumber"
                id="vehicleNumber"
                class="form-control"
                required
                placeholder="Enter Vehicle Number"
                formControlName="vehicleNumber"
              />
            </div>
            <div
              *ngIf="
                slotBookingForm.get('vehicleNumber')?.touched &&
                slotBookingForm.get('vehicleNumber')?.invalid
              "
              class="error-message"
            >
              Vehicle Number is required
            </div>
            <!-- Booked Name -->
            <div class="form-group">
              <label for="bookedName" class="form-label">Name</label>
              <input
                type="text"
                name="bookedName"
                id="bookedName"
                class="form-control"
                placeholder="Enter your name"
                formControlName="bookedName"
              />
            </div>
          </form>
        </div>
        <div class="modal-footer">
          <button
            type="button"
            class="btn btn-secondary"
            data-bs-dismiss="modal"
          >
            Close
          </button>
          <button
            type="button"
            class="btn btn-primary"
            id="slotBookingBtn"
            (click)="onBookSlot()"
          >
            Book Slot
          </button>
        </div>
      </div>
    </div>
  </div>
  <!-- Release Slot Modal -->
  <div
    class="modal fade"
    id="slotReleaseModal"
    tabindex="-1"
    aria-labelledby="slotReleaseModal"
    aria-hidden="true"
  >
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h1 class="modal-title fs-5" id="slotReleaseModalTitle">
            Release Slot - {{ selectedSlot?.id }}
          </h1>
          <button
            type="button"
            class="btn-close"
            data-bs-dismiss="modal"
            aria-label="Close"
          ></button>
        </div>
        <div class="modal-body">
          Are you sure to unpark the vehicle and release the slot?
        </div>
        <div class="modal-footer">
          <button
            type="button"
            class="btn btn-secondary"
            data-bs-dismiss="modal"
          >
            Close
          </button>
          <button
            type="button"
            class="btn btn-primary"
            (click)="onReleaseSlot()"
          >
            Release Slot
          </button>
        </div>
      </div>
    </div>
  </div>
</div>
